(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[736],{3268:(e,r,s)=>{Promise.resolve().then(s.bind(s,2146)),Promise.resolve().then(s.bind(s,255)),Promise.resolve().then(s.bind(s,9530))},9530:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>B});var t=s(5155),a=s(2115),i=s(5127),l=s(2523),n=s(285),o=s(6695),c=s(4165),d=s(9409),m=s(10),h=s(3991),u=s(3126),x=s(3481),g=s(3568),p=s(9442),j=s.n(p);async function v(e){return new Promise((r,s)=>{let t=new Image;t.onload=()=>{let e=document.createElement("canvas"),s=e.getContext("2d");e.width=t.width,e.height=t.height,s.drawImage(t,0,0);let a=s.getImageData(0,0,e.width,e.height),i=a.data;for(let e=0;e<i.length;e+=4){let r=i[e],s=1.011741861793261*(255*(.299*r+.587*i[e+1]+.114*i[e+2]>128)-128)+128;i[e]=s,i[e+1]=s,i[e+2]=s}s.putImageData(a,0,0);let l=document.createElement("canvas"),n=l.getContext("2d");l.width=2*e.width,l.height=2*e.height,n.imageSmoothingEnabled=!1,n.drawImage(e,0,0,l.width,l.height),r(l)},t.onerror=s,t.src=URL.createObjectURL(e)})}async function f(e){try{let r=await v(e);return(await j().recognize(r,"eng",{logger:e=>console.log(e)})).data.text}catch(e){throw console.error("Error during image recognition:",e),e}}var y=s(3833);s(4534);let b=e=>{let{onProcessComplete:r,className:s}=e,[i,l]=(0,a.useState)(""),[o,c]=(0,a.useState)(null),d=(0,a.useRef)(null),m=(0,a.useRef)(null),[h,u]=(0,a.useState)(),[x,p]=(0,a.useState)(),[j,v]=(0,a.useState)(!1),[b,N]=(0,a.useState)(!1),R=void 0,C=async()=>{if(!x||!d.current||!o)return void g.oR.error("Please select an image and define a crop area.");N(!0);try{let e=await function(e,r,s){let t=document.createElement("canvas"),a=e.naturalWidth/e.width,i=e.naturalHeight/e.height;t.width=r.width*a,t.height=r.height*i;let l=t.getContext("2d");return l?(l.drawImage(e,r.x*a,r.y*i,r.width*a,r.height*i,0,0,r.width*a,r.height*i),new Promise(e=>{t.toBlob(r=>{if(!r){console.error("Canvas is empty"),e(null);return}e(new File([r],s,{type:r.type}))},"image/png")})):Promise.resolve(null)}(d.current,x,o.name);if(e){let s=await f(e),t=function(e){let r=[];for(let s of e.split("\n").map(e=>e.trim()).filter(e=>e.length>0).filter(e=>!e.includes("PLAYER MANAGEMENT")).filter(e=>!e.includes("Select"))){console.log("Processing line:",s);let e=s.match(/([A-Z]\.\s*[A-Za-z]+).*?(\d{2})/g);if(e){console.log("Found matches:",e);let t=s.match(/([A-Z]\.\s*[A-Za-z]+)/),a=s.match(/\d{2}/);if(t&&a){let e=t[1].trim(),s=a[0],i=parseInt(s);i>=40&&i<=99&&(r.push({name:e.trim(),position:"",year:"",rating:s,isRedshirted:!1}),console.log("Added player:",e,s))}}}return console.log("Final parsed players:",r),r}(s);r(t),g.oR.success("Roster processed from cropped image!")}else g.oR.error("Failed to crop image.")}catch(e){console.error("Error processing cropped image:",e),g.oR.error("Error processing image. Check console for details.")}finally{N(!1)}};return(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4 ".concat(s),children:[(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{if(e.target.files&&e.target.files[0]){let r=e.target.files[0];c(r),u(void 0);let s=new FileReader;s.addEventListener("load",()=>{var e;l((null==(e=s.result)?void 0:e.toString())||""),v(!0)}),s.readAsDataURL(r)}else c(null),l(""),v(!1)},ref:m,className:"hidden",id:"roster-image-upload-input-cropper"}),!j&&(0,t.jsx)(n.$,{type:"button",variant:"outline",onClick:()=>{var e;null==(e=m.current)||e.click()},className:"w-full sm:w-auto",children:"Upload Roster Image"}),j&&i&&(0,t.jsxs)("div",{className:"w-full max-w-2xl p-4 border rounded-md shadow-sm bg-card",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2 text-center",children:"Drag to select the area containing player names, positions, and overall ratings."}),(0,t.jsx)("div",{className:"max-h-[60vh] overflow-auto flex justify-center",children:(0,t.jsx)(y.Ay,{crop:h,onChange:(e,r)=>u(r),onComplete:e=>p(e),aspect:R,children:(0,t.jsx)("img",{ref:d,alt:"Crop me",src:i,onLoad:e=>{d.current=e.currentTarget;let{width:r,height:s}=e.currentTarget;u((0,y.ge)((0,y.dS)({unit:"%",width:50},R||r/s,r,s),r,s)),p(void 0)},style:{maxHeight:"55vh",objectFit:"contain"}})})}),(0,t.jsxs)("div",{className:"flex justify-center gap-4 mt-4",children:[(0,t.jsx)(n.$,{onClick:C,disabled:!x||b,children:b?"Processing...":"Confirm Crop & Process"}),(0,t.jsx)(n.$,{variant:"outline",onClick:()=>{v(!1),l(""),c(null),m.current&&(m.current.value="")},disabled:b,children:"Cancel"})]})]})]})};var N=s(239),R=s(4084),C=s(4616),w=s(1788),S=s(6752),k=s(9917),A=s(2525),P=s(1540),E=s(408),T=s.n(E),I=s(9869),F=s(1368);let J=e=>{let{onImportComplete:r}=e,s=(0,a.useRef)(null),i=e=>{let r=Object.keys(e[0]||{}),s=["Jersey #","Name","Position","Year","Rating","Development Trait","Notes"].filter(e=>!r.includes(e));if(s.length>0)throw Error("Missing required columns: ".concat(s.join(", ")));return e.map(e=>{var r,s;return{jerseyNumber:(null==(r=e["Jersey #"])?void 0:r.toString())||"",name:e.Name||"",position:e.Position||"",year:e.Year||"",rating:(null==(s=e.Rating)?void 0:s.toString())||"",devTrait:e["Development Trait"]||"Normal",notes:e.Notes||""}})};return(0,t.jsxs)("div",{className:"inline-block",children:[(0,t.jsx)("input",{type:"file",accept:".csv",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&T().parse(a,{header:!0,complete:e=>{try{let t=i(e.data).map(e=>({...e,id:(0,F.A)(),isRedshirted:!1}));r(t),g.oR.success("Roster imported successfully"),s.current&&(s.current.value="")}catch(e){g.oR.error(e instanceof Error?e.message:"Invalid CSV format")}},error:e=>{g.oR.error("Error parsing CSV file"),console.error("CSV Parse Error:",e)}})},className:"hidden",ref:s}),(0,t.jsxs)("button",{onClick:()=>{var e;return null==(e=s.current)?void 0:e.click()},className:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2",children:[(0,t.jsx)(I.A,{className:"h-4 w-4 mr-2"}),"Import Roster"]})]})};var O=s(5057),D=s(5692),V=s(2461);let L=["FR","FR (RS)","SO","SO (RS)","JR","JR (RS)","SR","SR (RS)"],$=["Normal","Impact","Star","Elite"],q={FR:0,"FR (RS)":1,SO:2,"SO (RS)":3,JR:4,"JR (RS)":5,SR:6,"SR (RS)":7},Y={Normal:0,Impact:1,Star:2,Elite:3},_="offense",X="defense",Z="specialTeams",z={jerseyNumber:"",name:"",position:"",year:"",rating:"",devTrait:"Normal",notes:"",isRedshirted:!1},U=e=>{let{trait:r}=e;return(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm/6 font-medium ".concat({Elite:"bg-green-500 text-white dark:bg-green-500 dark:text-white",Star:"bg-blue-500 text-white dark:bg-blue-500 dark:text-white",Impact:"bg-yellow-500 text-white dark:bg-yellow-500 dark:text-white",Normal:"bg-red-500 text-white dark:bg-red-500 dark:text-white"}[r]),children:r})},B=()=>{let[e,r]=(0,h.A)("players",[]),[s,p]=(0,a.useState)([]),[j,v]=(0,a.useState)(z),[f,y]=(0,a.useState)(null),[E,I]=(0,a.useState)({field:"rating",direction:"desc"}),[B,M]=(0,a.useState)({}),[H,G]=(0,a.useState)("all"),{selectedPlayer:Q,isOpen:W,openPlayerCard:K,closePlayerCard:ee}=(0,D.n)(),[er,es]=(0,a.useState)(!1);(0,a.useEffect)(()=>{"all"===H?p(e):H===_?p(e.filter(e=>N.pL.includes(e.position))):H===X?p(e.filter(e=>N._N.includes(e.position))):H===Z?p(e.filter(e=>N.Qi.includes(e.position))):p(e.filter(e=>e.position===H))},[H,e]);let et=(0,a.useCallback)(e=>{r(r=>[...r,...e.map(e=>({id:(0,F.A)(),jerseyNumber:e.jerseyNumber||"",name:e.name||"N/A",position:e.position||"",year:e.year||"",rating:e.rating||"0",devTrait:e.devTrait||"Normal",notes:e.notes||"",isRedshirted:e.isRedshirted||!1}))]),g.oR.success("Roster imported successfully!")},[r]),ea=(0,a.useCallback)(()=>{let r=e.map(e=>({"Jersey #":e.jerseyNumber,Name:e.name,Position:e.position,Year:e.year,Rating:e.rating,"Dev. Trait":e.devTrait,"Is Redshirted":e.isRedshirted?"Yes":"No",Notes:e.notes})),s=new Blob([T().unparse(r)],{type:"text/csv;charset=utf-8"});(0,P.saveAs)(s,"roster-".concat(new Date().toISOString().split("T")[0],".csv")),(0,R.VX)("Roster exported successfully")},[e]),ei=(0,a.useMemo)(()=>[...s].sort((e,r)=>{if("jersey #"===E.field)return"asc"===E.direction?e.jerseyNumber.localeCompare(r.jerseyNumber,void 0,{numeric:!0}):r.jerseyNumber.localeCompare(e.jerseyNumber,void 0,{numeric:!0});if("year"===E.field)return"asc"===E.direction?q[e.year]-q[r.year]:q[r.year]-q[e.year];if("rating"===E.field)return"asc"===E.direction?parseInt(e.rating)-parseInt(r.rating):parseInt(r.rating)-parseInt(e.rating);if("dev. trait"===E.field)return"asc"===E.direction?Y[e.devTrait]-Y[r.devTrait]:Y[r.devTrait]-Y[e.devTrait];let s=E.field;return"asc"===E.direction?e[s].localeCompare(r[s]):r[s].localeCompare(e[s])}),[s,E]),el=(0,a.useCallback)(e=>{I(r=>({field:e,direction:r.field===e&&"desc"===r.direction?"asc":"desc"}))},[]),en=(0,a.useCallback)(e=>{let r={};return e.jerseyNumber.trim()&&/^\d+$/.test(e.jerseyNumber)||(r.jerseyNumber="Jersey # is required and must be a number."),(0,x.yS)(e.name)||(r.name="Name is required (max 100 chars)."),(0,x.o3)(e.position)||(r.position="Please select a position."),(0,x.QY)(e.rating)||(r.rating="Rating must be 0-99."),M(r),0===Object.keys(r).length},[]),eo=(0,a.useCallback)(e=>{y(e.id),v(e),M({}),es(!0)},[]),ec=(0,a.useCallback)(()=>{f?en(j)?(r(e=>e.map(e=>e.id===f?{...j,id:e.id,name:(0,u.k)(j.name)}:e)),(0,R.VX)(R.nl.SAVE_SUCCESS),es(!1)):g.oR.error("Please correct errors before saving."):en(j)?(r(e=>[...e,{...j,id:(0,F.A)(),name:(0,u.k)(j.name)}]),(0,R.VX)("Player added successfully!"),es(!1)):g.oR.error("Please correct errors before adding.")},[j,f,en,r]),ed=(0,a.useCallback)(e=>{r(r=>r.filter(r=>r.id!==e)),(0,R.VX)(R.nl.DELETE_SUCCESS)},[r]),em=(0,a.useCallback)(e=>{let s=e.map(e=>({...e,id:(0,F.A)(),jerseyNumber:"",devTrait:"Normal",notes:"",isRedshirted:!1}));r(e=>[...e,...s]),(0,R.VX)("Players processed from image!")},[r]),eh=(0,a.useCallback)(e=>{r(r=>r.map(r=>r.id===e?{...r,isRedshirted:!r.isRedshirted}:r))},[r]),eu=(0,a.useCallback)(e=>"border-t transition-colors ".concat(e.isRedshirted?"bg-red-100 dark:bg-red-900/30 hover:bg-red-200/80 dark:hover:bg-red-800/50":"hover:bg-muted/50"),[]);return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-center",children:"Roster Management"}),(0,t.jsxs)(o.Zp,{className:"shadow-lg",children:[(0,t.jsx)(o.aR,{children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,t.jsx)(o.ZB,{className:"text-xl font-semibold",children:"Team Roster"}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsxs)(n.$,{onClick:()=>{y(null),v(z),M({}),es(!0)},className:"btn-school-primary",children:[(0,t.jsx)(C.A,{className:"h-4 w-4 mr-2"}),"Add New Player"]}),(0,t.jsx)(b,{onProcessComplete:em}),(0,t.jsx)(J,{onImportComplete:et}),(0,t.jsxs)(n.$,{onClick:ea,variant:"outline",children:[(0,t.jsx)(w.A,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})]})}),(0,t.jsxs)(o.Wu,{children:[(0,t.jsx)("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/4 pb-4",children:(0,t.jsxs)(d.l6,{value:H,onValueChange:e=>G(e),children:[(0,t.jsx)(d.bq,{children:(0,t.jsx)(d.yv,{placeholder:"Filter by Position"})}),(0,t.jsxs)(d.gC,{children:[(0,t.jsx)(d.eb,{value:"all",children:"All Positions"}),(0,t.jsx)(d.eb,{value:_,children:"Offense"}),(0,t.jsx)(d.eb,{value:X,children:"Defense"}),(0,t.jsx)(d.eb,{value:Z,children:"Special Teams"}),N.Xq.map(e=>(0,t.jsx)(d.eb,{value:e,children:e},e))]})]})}),ei.length>0?(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(i.XI,{children:[(0,t.jsx)(i.A0,{children:(0,t.jsx)(i.Hj,{children:["Jersey #","Name","Position","Year","Rating","Dev. Trait","Notes","Actions"].map(e=>(0,t.jsx)(i.nd,{className:"text-center cursor-pointer",onClick:()=>"Actions"!==e&&el(e.toLowerCase()),children:(0,t.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[e,"Actions"!==e&&E.field===e.toLowerCase()&&("asc"===E.direction?" ▲":" ▼")]})},e))})}),(0,t.jsx)(i.BF,{children:ei.map(e=>(0,t.jsxs)(i.Hj,{className:eu(e),children:[(0,t.jsx)(i.nA,{className:"text-center font-mono",children:e.jerseyNumber}),(0,t.jsx)(i.nA,{className:"text-center font-medium",children:(0,t.jsx)("button",{onClick:()=>K(e),className:"hover:underline",children:e.name})}),(0,t.jsx)(i.nA,{className:"text-center",children:e.position}),(0,t.jsx)(i.nA,{className:"text-center",children:e.year}),(0,t.jsx)(i.nA,{className:"text-center font-bold",children:e.rating}),(0,t.jsx)(i.nA,{className:"text-center",children:(0,t.jsx)(U,{trait:e.devTrait})}),(0,t.jsx)(i.nA,{className:"text-center text-sm text-muted-foreground max-w-xs truncate",title:e.notes,children:e.notes}),(0,t.jsx)(i.nA,{className:"text-center",children:(0,t.jsxs)("div",{className:"flex items-center gap-1 justify-center",children:[(0,t.jsx)(n.$,{variant:"ghost",size:"icon",onClick:()=>eh(e.id),title:e.year.includes("(RS)")?"Player has already used a redshirt":e.isRedshirted?"Remove Redshirt":"Add Redshirt",disabled:e.year.includes("(RS)"),children:(0,t.jsx)(S.A,{className:"h-4 w-4 ".concat(e.isRedshirted?"text-red-600":"text-muted-foreground")})}),(0,t.jsx)(n.$,{variant:"ghost",size:"icon",onClick:()=>eo(e),title:"Edit Player",children:(0,t.jsx)(k.A,{className:"h-4 w-4"})}),(0,t.jsxs)(m.Lt,{children:[(0,t.jsx)(m.tv,{asChild:!0,children:(0,t.jsx)(n.$,{variant:"ghost",size:"icon",title:"Remove Player",children:(0,t.jsx)(A.A,{className:"h-4 w-4 text-red-500"})})}),(0,t.jsxs)(m.EO,{children:[(0,t.jsxs)(m.wd,{children:[(0,t.jsx)(m.r7,{children:"Remove Player"}),(0,t.jsxs)(m.$v,{children:["Are you sure you want to remove ",e.name,"?"]})]}),(0,t.jsxs)(m.ck,{children:[(0,t.jsx)(m.Zr,{children:"Cancel"}),(0,t.jsx)(m.Rx,{onClick:()=>ed(e.id),children:"Remove"})]})]})]})]})})]},e.id))})]})}):(0,t.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"No players found. Add a player or adjust filters."})]})]}),(0,t.jsx)(c.lG,{open:er,onOpenChange:es,children:(0,t.jsxs)(c.Cf,{className:"sm:max-w-[800px]",children:[(0,t.jsxs)(c.c7,{children:[(0,t.jsx)(c.L3,{children:f?"Edit Player":"Add New Player"}),(0,t.jsx)(o.BT,{children:"Fill in the details for the player."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(O.J,{htmlFor:"jerseyNumber",children:"Jersey #"}),(0,t.jsx)(l.p,{id:"jerseyNumber",value:j.jerseyNumber,onChange:e=>v(r=>({...r,jerseyNumber:e.target.value.replace(/\D/g,"").slice(0,2)})),placeholder:"#",className:B.jerseyNumber?"border-red-500":""}),B.jerseyNumber&&(0,t.jsx)("p",{className:"text-red-500 text-xs",children:B.jerseyNumber})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(O.J,{htmlFor:"name",children:"Name"}),(0,t.jsx)(l.p,{id:"name",value:j.name,onChange:e=>v(r=>({...r,name:e.target.value})),placeholder:"John Doe",className:B.name?"border-red-500":""}),B.name&&(0,t.jsx)("p",{className:"text-red-500 text-xs",children:B.name})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(O.J,{htmlFor:"position",children:"Position"}),(0,t.jsxs)(d.l6,{value:j.position,onValueChange:e=>v(r=>({...r,position:e})),children:[(0,t.jsx)(d.bq,{id:"position",className:B.position?"border-red-500":"",children:(0,t.jsx)(d.yv,{placeholder:"Position"})}),(0,t.jsx)(d.gC,{children:N.Xq.map(e=>(0,t.jsx)(d.eb,{value:e,children:e},e))})]}),B.position&&(0,t.jsx)("p",{className:"text-red-500 text-xs",children:B.position})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(O.J,{htmlFor:"year",children:"Year"}),(0,t.jsxs)(d.l6,{value:j.year,onValueChange:e=>v(r=>({...r,year:e})),children:[(0,t.jsx)(d.bq,{id:"year",children:(0,t.jsx)(d.yv,{placeholder:"Year"})}),(0,t.jsx)(d.gC,{children:L.map(e=>(0,t.jsx)(d.eb,{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(O.J,{htmlFor:"rating",children:"Rating"}),(0,t.jsx)(l.p,{id:"rating",value:j.rating,onChange:e=>v(r=>({...r,rating:e.target.value.replace(/\D/g,"").slice(0,2)})),placeholder:"OVR",className:B.rating?"border-red-500":""}),B.rating&&(0,t.jsx)("p",{className:"text-red-500 text-xs",children:B.rating})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(O.J,{htmlFor:"devTrait",children:"Dev. Trait"}),(0,t.jsxs)(d.l6,{value:j.devTrait,onValueChange:e=>v(r=>({...r,devTrait:e})),children:[(0,t.jsx)(d.bq,{id:"devTrait",children:(0,t.jsx)(d.yv,{placeholder:"Trait"})}),(0,t.jsx)(d.gC,{children:$.map(e=>(0,t.jsx)(d.eb,{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{className:"space-y-1.5 col-span-1 md:col-span-2",children:[(0,t.jsx)(O.J,{htmlFor:"notes",children:"Notes"}),(0,t.jsx)(l.p,{id:"notes",value:j.notes,onChange:e=>v(r=>({...r,notes:e.target.value})),placeholder:"Optional notes..."})]})]}),(0,t.jsxs)(c.Es,{children:[(0,t.jsx)(n.$,{variant:"outline",onClick:()=>es(!1),children:"Cancel"}),(0,t.jsx)(n.$,{onClick:ec,children:f?"Save Changes":"Add Player"})]})]})}),Q&&(0,t.jsx)(V.A,{player:Q,isOpen:W,onClose:ee})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[111,201,13,533,121,649,930,915,231,88,458,808,441,684,358],()=>r(3268)),_N_E=e.O()}]);